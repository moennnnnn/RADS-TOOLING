-- =======================
-- RADS TOOLING COMPLETE DATABASE SCHEMA
-- Final Consolidated Version - October 2025
-- =======================
-- Supports:
--   ✓ Premade Products + Custom Cabinets
--   ✓ Full E-commerce Flow (Cart → Checkout → Order Tracking)
--   ✓ Dual Chat System (Guest + Customer Support)
--   ✓ Order Cancellation Tracking
--   ✓ Content Management (Announcements/Banners)
--   ✓ User Activity Logs & Security
--   ✓ Password Reset System
--   ✓ Persistent Chat Clear (Customer view only)
--   ✓ Admin Read Status Tracking
-- =======================

-- ============================================================
-- PART 1: CORE USER TABLES
-- ============================================================

-- Staff users (Owner/Admin/Secretary)
CREATE TABLE IF NOT EXISTS admin_users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) UNIQUE NOT NULL,
    password VARCHAR(255) NOT NULL,
    full_name VARCHAR(100) NOT NULL,
    role ENUM('Owner', 'Admin', 'Secretary') NOT NULL DEFAULT 'Secretary',
    profile_image VARCHAR(255) DEFAULT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) ENGINE=InnoDB;

-- Insert default Owner account (only if doesn't exist)
INSERT IGNORE INTO admin_users (username, password, full_name, role)
VALUES (
    'admin',
    '$2y$10$tZQpbFsqPgp1f0eCMXI6ZeM9guDbJt6631WkLtuoZcN1eKazk/W4u', -- "admin123"
    'System Owner',
    'Owner'
);

-- Customers table (with email verification)
CREATE TABLE IF NOT EXISTS customers (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) UNIQUE NOT NULL,
    full_name VARCHAR(100) NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    profile_image VARCHAR(255) NULL,
    email_verified TINYINT(1) NOT NULL DEFAULT 0,
    verification_code VARCHAR(10) DEFAULT NULL,
    verification_expires DATETIME DEFAULT NULL,
    phone VARCHAR(20),
    address VARCHAR(255) NULL,
    password VARCHAR(255) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_email (email),
    INDEX idx_username (username)
) ENGINE=InnoDB;

-- ============================================================
-- PART 2: PRODUCT TABLES
-- ============================================================

-- Products table (premade cabinets)
CREATE TABLE IF NOT EXISTS products (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    type VARCHAR(50) NOT NULL,
    description TEXT,
    price DECIMAL(10,2) NOT NULL,
    stock INT DEFAULT 0,
    image VARCHAR(255),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_type (type),
    INDEX idx_stock (stock)
) ENGINE=InnoDB;

-- Customizable cabinet templates
CREATE TABLE IF NOT EXISTS cabinets (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    type VARCHAR(50) NOT NULL,
    base_price DECIMAL(10,2) NOT NULL,
    image VARCHAR(255),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_type (type)
) ENGINE=InnoDB;

-- Customer's saved cabinet designs
CREATE TABLE IF NOT EXISTS customizations (
    id INT AUTO_INCREMENT PRIMARY KEY,
    customer_id INT NOT NULL,
    cabinet_id INT NOT NULL,
    color VARCHAR(50),
    size VARCHAR(50),
    layout VARCHAR(50),
    material VARCHAR(50),
    price_adjustment DECIMAL(10,2) DEFAULT 0.00,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (customer_id) REFERENCES customers(id) ON DELETE CASCADE,
    FOREIGN KEY (cabinet_id) REFERENCES cabinets(id) ON DELETE CASCADE,
    INDEX idx_customer_id (customer_id),
    INDEX idx_cabinet_id (cabinet_id)
) ENGINE=InnoDB;

-- ============================================================
-- PART 3: SHOPPING CART
-- ============================================================

-- Shopping cart (supports BOTH products and custom cabinets)
CREATE TABLE IF NOT EXISTS cart_items (
    id INT AUTO_INCREMENT PRIMARY KEY,
    customer_id INT NOT NULL,
    item_type ENUM('product', 'cabinet') NOT NULL,
    product_id INT DEFAULT NULL,
    cabinet_id INT DEFAULT NULL,
    customization_id INT DEFAULT NULL,
    quantity INT DEFAULT 1,
    added_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (customer_id) REFERENCES customers(id) ON DELETE CASCADE,
    FOREIGN KEY (product_id) REFERENCES products(id) ON DELETE CASCADE,
    FOREIGN KEY (cabinet_id) REFERENCES cabinets(id) ON DELETE CASCADE,
    FOREIGN KEY (customization_id) REFERENCES customizations(id) ON DELETE SET NULL,
    INDEX idx_customer_id (customer_id),
    INDEX idx_item_type (item_type)
) ENGINE=InnoDB;

-- ============================================================
-- PART 4: ORDERS & PAYMENTS
-- ============================================================

-- Orders table
CREATE TABLE IF NOT EXISTS orders (
    id INT AUTO_INCREMENT PRIMARY KEY,
    order_code VARCHAR(20) UNIQUE NOT NULL,
    customer_id INT NOT NULL,
    total_amount DECIMAL(10,2) NOT NULL,
    payment_status ENUM('Pending', 'Partially Paid', 'Fully Paid') DEFAULT 'Pending',
    status ENUM('Pending', 'Processing', 'Completed', 'Cancelled') DEFAULT 'Pending',
    cancelled_by ENUM('customer', 'admin') DEFAULT NULL,
    cancellation_reason TEXT DEFAULT NULL,
    cancelled_at TIMESTAMP NULL,
    order_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (customer_id) REFERENCES customers(id) ON DELETE CASCADE,
    INDEX idx_customer_id (customer_id),
    INDEX idx_order_code (order_code),
    INDEX idx_status (status)
) ENGINE=InnoDB;

-- Order items
CREATE TABLE IF NOT EXISTS order_items (
    id INT AUTO_INCREMENT PRIMARY KEY,
    order_id INT NOT NULL,
    item_type ENUM('product', 'cabinet') NOT NULL,
    product_id INT DEFAULT NULL,
    cabinet_id INT DEFAULT NULL,
    customization_id INT DEFAULT NULL,
    quantity INT DEFAULT 1,
    unit_price DECIMAL(10,2) NOT NULL,
    subtotal DECIMAL(10,2) NOT NULL,
    FOREIGN KEY (order_id) REFERENCES orders(id) ON DELETE CASCADE,
    FOREIGN KEY (product_id) REFERENCES products(id) ON DELETE RESTRICT,
    FOREIGN KEY (cabinet_id) REFERENCES cabinets(id) ON DELETE RESTRICT,
    FOREIGN KEY (customization_id) REFERENCES customizations(id) ON DELETE SET NULL,
    INDEX idx_order_id (order_id),
    INDEX idx_item_type (item_type)
) ENGINE=InnoDB;

-- Order status timeline
CREATE TABLE IF NOT EXISTS order_status_history (
    id INT AUTO_INCREMENT PRIMARY KEY,
    order_id INT NOT NULL,
    status ENUM('Pending', 'Processing', 'Completed', 'Cancelled') NOT NULL,
    changed_by INT DEFAULT NULL,
    notes TEXT,
    changed_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (order_id) REFERENCES orders(id) ON DELETE CASCADE,
    FOREIGN KEY (changed_by) REFERENCES admin_users(id) ON DELETE SET NULL,
    INDEX idx_order_id (order_id),
    INDEX idx_changed_at (changed_at)
) ENGINE=InnoDB;

-- Payment records
CREATE TABLE IF NOT EXISTS payments (
    id INT AUTO_INCREMENT PRIMARY KEY,
    order_id INT NOT NULL,
    amount_paid DECIMAL(10,2) NOT NULL,
    payment_method ENUM('GCash QR', 'Cash', 'Bank Transfer', 'Cheque') NOT NULL,
    qr_code VARCHAR(255),
    payment_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    verified_by INT DEFAULT NULL,
    verified_at TIMESTAMP NULL,
    FOREIGN KEY (order_id) REFERENCES orders(id) ON DELETE CASCADE,
    FOREIGN KEY (verified_by) REFERENCES admin_users(id) ON DELETE SET NULL,
    INDEX idx_order_id (order_id),
    INDEX idx_payment_date (payment_date)
) ENGINE=InnoDB;

-- ============================================================
-- PART 5: FEEDBACK & MESSAGING
-- ============================================================

-- Feedback table
CREATE TABLE IF NOT EXISTS feedback (
    id INT AUTO_INCREMENT PRIMARY KEY,
    customer_id INT NOT NULL,
    order_id INT,
    rating INT CHECK (rating >= 1 AND rating <= 5),
    comment TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (customer_id) REFERENCES customers(id) ON DELETE CASCADE,
    FOREIGN KEY (order_id) REFERENCES orders(id) ON DELETE CASCADE,
    INDEX idx_customer_id (customer_id),
    INDEX idx_order_id (order_id)
) ENGINE=InnoDB;

-- Chat messages (logged-in customer ↔ admin communication)
CREATE TABLE IF NOT EXISTS messages (
    id INT AUTO_INCREMENT PRIMARY KEY,
    sender_type ENUM('customer', 'admin') NOT NULL,
    sender_id INT NOT NULL,
    receiver_type ENUM('customer', 'admin') NOT NULL,
    receiver_id INT NOT NULL,
    message TEXT NOT NULL,
    read_status TINYINT(1) DEFAULT 0,
    sent_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_sender (sender_type, sender_id),
    INDEX idx_receiver (receiver_type, receiver_id),
    INDEX idx_sent_at (sent_at)
) ENGINE=InnoDB;

-- ============================================================
-- PART 6: GUEST CHAT SUPPORT SYSTEM
-- ============================================================

-- Drop old chat tables if they exist
DROP TABLE IF EXISTS rt_chat_messages;
DROP TABLE IF EXISTS rt_chat_threads;
DROP TABLE IF EXISTS rt_faqs;
DROP TABLE IF EXISTS chat_messages;
DROP TABLE IF EXISTS chat_threads;
DROP TABLE IF EXISTS chat_faqs;

-- FAQs database (for chatbot auto-responses)
CREATE TABLE rt_faqs (
    id INT AUTO_INCREMENT PRIMARY KEY,
    question VARCHAR(255) NOT NULL,
    answer TEXT NOT NULL,
    is_active TINYINT(1) DEFAULT 1,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_active (is_active),
    INDEX idx_created (created_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- Chat threads (customer chat sessions)
CREATE TABLE rt_chat_threads (
    id INT AUTO_INCREMENT PRIMARY KEY,
    thread_code VARCHAR(32) UNIQUE NOT NULL,
    customer_id INT DEFAULT NULL,
    customer_name VARCHAR(120) NULL,
    customer_email VARCHAR(160) NULL,
    customer_phone VARCHAR(64) NULL,
    status ENUM('open','closed') DEFAULT 'open',
    last_message_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    admin_last_read DATETIME DEFAULT NULL,
    customer_cleared_at DATETIME DEFAULT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (customer_id) REFERENCES customers(id) ON DELETE SET NULL,
    INDEX idx_code (thread_code),
    INDEX idx_customer_id (customer_id),
    INDEX idx_last_message (last_message_at),
    INDEX idx_status (status)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- Chat messages (messages in threads)
CREATE TABLE rt_chat_messages (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    thread_id INT NOT NULL,
    sender_type ENUM('customer','admin','bot') NOT NULL,
    sender_id INT NULL,
    body TEXT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_thread (thread_id),
    INDEX idx_sender (sender_type),
    INDEX idx_created (created_at),
    CONSTRAINT fk_rt_msg_thread 
        FOREIGN KEY (thread_id) 
        REFERENCES rt_chat_threads(id) 
        ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- Seed Sample FAQs
INSERT INTO rt_faqs (question, answer, is_active) VALUES
('operating hours', 'We operate from 8am-5pm', 1),
('operating hours?', 'We operate from 8am-5pm', 1),
('What are your operating hours?', 'We operate from 8am-5pm', 1),
('hours', 'We operate from 8am-5pm', 1),
('delivery', 'Yes, we deliver within Cavite and nearby cities. Fees vary by location.', 1),
('deliver', 'Yes, we deliver within Cavite and nearby cities. Fees vary by location.', 1),
('do you deliver', 'Yes, we deliver within Cavite and nearby cities. Fees vary by location.', 1),
('do you deliver?', 'Yes, we deliver within Cavite and nearby cities. Fees vary by location.', 1),
('customize', 'Yes! Share your preferred dimensions and color; we will confirm feasibility and pricing.', 1),
('customization', 'Yes! Share your preferred dimensions and color; we will confirm feasibility and pricing.', 1),
('Can I customize size/color?', 'Yes! Share your preferred dimensions and color; we will confirm feasibility and pricing.', 1),
('lead time', 'Typical build time is 7–14 days depending on customization.', 1),
('lead times', 'Typical build time is 7–14 days depending on customization.', 1),
('What are your lead times?', 'Typical build time is 7–14 days depending on customization.', 1),
('location', 'We are located at Green Breeze, Piela, Dasmarinas Cavite.', 1),
('located', 'We are located at Green Breeze, Piela, Dasmarinas Cavite.', 1),
('Where are you located?', 'We are located at Green Breeze, Piela, Dasmarinas Cavite.', 1);

-- ============================================================
-- PART 7: CONTENT MANAGEMENT
-- ============================================================

-- Homepage announcements/banners/promotions
CREATE TABLE IF NOT EXISTS announcements (
    id INT AUTO_INCREMENT PRIMARY KEY,
    title VARCHAR(200) NOT NULL,
    content TEXT,
    type ENUM('banner', 'promotion', 'announcement') DEFAULT 'announcement',
    image VARCHAR(255),
    is_active TINYINT(1) DEFAULT 1,
    display_order INT DEFAULT 0,
    created_by INT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (created_by) REFERENCES admin_users(id) ON DELETE CASCADE,
    INDEX idx_is_active (is_active),
    INDEX idx_type (type),
    INDEX idx_display_order (display_order)
) ENGINE=InnoDB;

-- ============================================================
-- PART 8: SECURITY & AUDIT
-- ============================================================

-- User activity logs
CREATE TABLE IF NOT EXISTS user_logs (
    id INT AUTO_INCREMENT PRIMARY KEY,
    user_type ENUM('customer', 'admin') NOT NULL,
    user_id INT NOT NULL,
    action VARCHAR(100) NOT NULL,
    details TEXT,
    ip_address VARCHAR(45),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_user_type_id (user_type, user_id),
    INDEX idx_action (action),
    INDEX idx_created_at (created_at)
) ENGINE=InnoDB;

-- Password reset tokens
CREATE TABLE IF NOT EXISTS password_resets (
    id INT AUTO_INCREMENT PRIMARY KEY,
    user_type ENUM('customer', 'admin') NOT NULL,
    user_id INT NOT NULL,
    token VARCHAR(64) UNIQUE NOT NULL,
    expires_at DATETIME NOT NULL,
    used TINYINT(1) DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_token (token),
    INDEX idx_user_type_id (user_type, user_id),
    INDEX idx_expires_at (expires_at)
) ENGINE=InnoDB;

-- Add column to store when customer cleared their view
ALTER TABLE rt_chat_threads 
ADD COLUMN customer_cleared_at DATETIME DEFAULT NULL;

-- Content Management System Pages Table
CREATE TABLE IF NOT EXISTS rt_cms_pages (
    id INT AUTO_INCREMENT PRIMARY KEY,
    page_key VARCHAR(50) NOT NULL,
    page_name VARCHAR(100) NOT NULL,
    content_data JSON NOT NULL,
    status ENUM('draft', 'published') DEFAULT 'draft',
    version INT DEFAULT 1,
    updated_by VARCHAR(100),
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_page_key (page_key),
    INDEX idx_status (status),
    INDEX idx_updated (updated_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- Insert default content for each page
INSERT INTO rt_cms_pages (page_key, page_name, content_data, status, version, updated_by) VALUES
('home', 'Homepage', '{"hero_headline":"<h1>Welcome to RADS Tooling</h1>","hero_subtext":"<p>Your trusted partner in custom cabinets</p>","promo_text":"<p>Quality cabinets at affordable prices!</p>"}', 'published', 1, 'System'),
('about', 'About Us', '{"about_mission":"<p>To provide high-quality custom cabinets</p>","about_vision":"<p>To be the leading cabinet manufacturer in Cavite</p>","about_narrative":"<p>Established in 2007, we have been serving customers for over 17 years</p>","about_address":"Green Breeze, Piela, Dasmariñas, Cavite","about_phone":"+63 976 228 4270","about_email":"radstooling@gmail.com","about_hours_weekday":"Mon-Sat: 8:00 AM - 5:00 PM","about_hours_sunday":"Sunday: Closed"}', 'published', 1, 'System'),
('privacy', 'Privacy Policy', '{"content":"<h2>Privacy Policy</h2><p>Your privacy is important to us...</p>"}', 'published', 1, 'System'),
('terms', 'Terms & Conditions', '{"content":"<h2>Terms & Conditions</h2><p>By using our services...</p>"}', 'published', 1, 'System'),
('global', 'Navigation & Footer', '{"nav_home":"Home","nav_about":"About","nav_products":"Products","global_phone":"+63 976 228 4270","global_email":"radstooling@gmail.com","footer_about":"Premium custom cabinet manufacturer","footer_copyright":"© 2025 RADS TOOLING INC. All rights reserved."}', 'published', 1, 'System');

-- Drop old table if exists
DROP TABLE IF EXISTS rt_cms_pages;

-- Create new simplified table
CREATE TABLE rt_cms_pages (
    id INT AUTO_INCREMENT PRIMARY KEY,
    page_key VARCHAR(50) NOT NULL,
    page_name VARCHAR(100) NOT NULL,
    content_data JSON NOT NULL,
    status ENUM('draft', 'published') DEFAULT 'draft',
    version INT DEFAULT 1,
    updated_by VARCHAR(100),
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_page_key_status (page_key, status),
    INDEX idx_updated (updated_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

INSERT INTO rt_cms_pages (page_key, page_name, content_data, status, version, updated_by) VALUES

-- PUBLIC HOMEPAGE
('home_public', 'Public Homepage', 
JSON_OBJECT(
  'hero_headline', '<h1><span style="color: #2f5b88;">C</span>ustomize Your Dream Cabinets</h1>',
  'hero_subtitle', '<p>Design, visualize, and order premium custom cabinets online. Choose your style, materials, and finishes with our 360° preview tool.</p>',
  'hero_image', '/RADS-TOOLING/assets/images/cabinet-hero.jpg',
  
  'features_title', '<h2>Why Choose <span style="color: #667eea;">RADS TOOLING</span>?</h2>',
  'features_subtitle', '<p>Everything you need to create your perfect cabinet</p>',
  
  'carousel_images', JSON_ARRAY(
    JSON_OBJECT('image', '/RADS-TOOLING/assets/images/cab1.jpg', 'title', 'Modern Kitchen', 'description', 'Contemporary design with premium finishes'),
    JSON_OBJECT('image', '/RADS-TOOLING/assets/images/cab2.jpg', 'title', 'Bedroom Wardrobe', 'description', 'Spacious storage with elegant styling'),
    JSON_OBJECT('image', '/RADS-TOOLING/assets/images/cab3.jpg', 'title', 'Living Room Display', 'description', 'Showcase your style with custom shelving'),
    JSON_OBJECT('image', '/RADS-TOOLING/assets/images/cab4.jpg', 'title', 'Bathroom Vanity', 'description', 'Water-resistant premium materials'),
    JSON_OBJECT('image', '/RADS-TOOLING/assets/images/cab5.jpg', 'title', 'Office Storage', 'description', 'Professional workspace solutions')
  ),
  
  'video_title', '<h2><span style="color: #2f5b88;">C</span>rafted with Passion & Precision</h2>',
  'video_subtitle', '<p>Every cabinet is handcrafted by skilled artisans using premium materials. Watch our craftsmen bring your vision to life.</p>',
  'video_url', '/RADS-TOOLING/assets/videos/crafting.mp4',
  'video_poster', '/RADS-TOOLING/assets/images/video-poster.jpg',
  
  'cta_headline', '<h2>Ready to Design Your Dream Cabinet?</h2>',
  'cta_text', '<p>Join hundreds of satisfied customers who transformed their spaces</p>',
  
  'footer_company', 'RADS TOOLING',
  'footer_description', 'Premium custom cabinet manufacturer serving clients since 2007. Quality craftsmanship, affordable prices, and exceptional service.',
  'footer_address', 'Green Breeze, Piela, Dasmariñas, Cavite',
  'footer_email', 'RadsTooling@gmail.com',
  'footer_phone', '+63 976 228 4270',
  'footer_hours', 'Mon-Sat: 8:00 AM - 5:00 PM',
  'footer_copyright', '© 2025 RADS TOOLING INC. All rights reserved.'
),
'published', 1, 'System'),

-- CUSTOMER HOMEPAGE
('home_customer', 'Customer Homepage',
JSON_OBJECT(
  'welcome_message', '<h1>Welcome back, <span style="color: #2f5b88;">{{customer_name}}</span>!</h1>',
  'intro_text', '<p>Explore our latest cabinet designs and continue your projects</p>',
  'footer_email', 'RadsTooling@gmail.com',
  'footer_phone', '+63 976 228 4270',
  'footer_address', 'Green Breeze, Piela, Dasmariñas, Cavite',
  'footer_hours', 'Mon-Sat: 8:00 AM - 5:00 PM'
),
'published', 1, 'System'),

INSERT INTO rt_cms_pages (page_key, page_name, content_data, status, version, updated_by) VALUES
('about', 'About Us', JSON_OBJECT(
    'about_hero_image', '/RADS-TOOLING/assets/images/store.jpg',
    'about_headline', 'About RADS Tooling',
    'about_subheadline', '<p>Your trusted partner in precision tooling and industrial solutions</p>',
    'about_mission', '<p>To provide high-quality custom cabinets and tooling solutions that exceed customer expectations through superior craftsmanship, innovative design, and exceptional service.</p>',
    'about_vision', '<p>To be the leading cabinet manufacturer in Cavite, recognized for quality, reliability, and customer satisfaction.</p>',
    'about_story', '<p>Established in 2007, RADS Tooling has been serving customers for over 17 years. We started as a small workshop and have grown into a trusted name in custom cabinet manufacturing. Our commitment to quality and customer satisfaction has made us the preferred choice for homeowners and businesses alike.</p><p>Every cabinet we create is handcrafted by skilled artisans using premium materials and modern techniques. We combine traditional craftsmanship with innovative design to deliver products that stand the test of time.</p>',
    'about_address', 'Green Breeze, Piela, Dasmariñas, Cavite',
    'about_phone', '+63 976 228 4270',
    'about_email', 'radstooling@gmail.com',
    'about_hours_weekday', 'Mon-Sat: 8:00 AM - 5:00 PM',
    'about_hours_sunday', 'Sunday: Closed'
), 'published', 1, 'System');

-- Insert PRIVACY POLICY with full content
INSERT INTO rt_cms_pages (page_key, page_name, content_data, status, version, updated_by) VALUES
('privacy', 'Privacy Policy', JSON_OBJECT(
    'content', '<h1>Privacy Policy</h1>
<p><em>Last updated: January 2024</em></p>

<h2>1. Introduction</h2>
<p>Welcome to RADS Tooling. We are committed to protecting your personal information and your right to privacy. This Privacy Policy explains what information we collect, how we use it, and what rights you have in relation to it.</p>

<h2>2. Information We Collect</h2>
<h3>Personal Information</h3>
<p>We collect personal information that you voluntarily provide to us when you:</p>
<ul>
    <li>Register for an account on our website</li>
    <li>Place an order for our products or services</li>
    <li>Subscribe to our newsletter</li>
    <li>Contact us with inquiries</li>
    <li>Participate in customer surveys or promotions</li>
</ul>

<p>This information may include:</p>
<ul>
    <li>Name and contact details (email address, phone number, mailing address)</li>
    <li>Account credentials (username and password)</li>
    <li>Payment information (credit card details, billing address)</li>
    <li>Order history and preferences</li>
    <li>Communication preferences</li>
</ul>

<h3>Automatically Collected Information</h3>
<p>When you visit our website, we automatically collect certain information about your device and browsing behavior:</p>
<ul>
    <li>IP address and device identifiers</li>
    <li>Browser type and version</li>
    <li>Operating system</li>
    <li>Pages visited and time spent on pages</li>
    <li>Referring website addresses</li>
    <li>Clickstream data</li>
</ul>

<h2>3. How We Use Your Information</h2>
<p>We use your personal information for the following purposes:</p>
<ul>
    <li><strong>Order Processing:</strong> To process and fulfill your orders, including payment processing and delivery</li>
    <li><strong>Customer Service:</strong> To respond to your inquiries and provide customer support</li>
    <li><strong>Account Management:</strong> To create and manage your account</li>
    <li><strong>Marketing:</strong> To send you promotional materials and updates about our products (with your consent)</li>
    <li><strong>Personalization:</strong> To customize your experience on our website</li>
    <li><strong>Analytics:</strong> To analyze website usage and improve our services</li>
    <li><strong>Legal Compliance:</strong> To comply with legal obligations and protect our rights</li>
</ul>

<h2>4. Information Sharing and Disclosure</h2>
<p>We do not sell your personal information. We may share your information with:</p>
<ul>
    <li><strong>Service Providers:</strong> Third-party companies that help us operate our business (payment processors, shipping companies, email service providers)</li>
    <li><strong>Business Partners:</strong> Partners who help us provide our services, subject to confidentiality agreements</li>
    <li><strong>Legal Authorities:</strong> When required by law or to protect our rights and safety</li>
    <li><strong>Business Transfers:</strong> In connection with a merger, acquisition, or sale of assets</li>
</ul>

<h2>5. Cookies and Tracking Technologies</h2>
<p>We use cookies and similar tracking technologies to:</p>
<ul>
    <li>Remember your preferences and settings</li>
    <li>Understand how you use our website</li>
    <li>Improve website performance</li>
    <li>Deliver relevant advertisements</li>
</ul>

<p>You can control cookie preferences through your browser settings. However, disabling cookies may affect website functionality.</p>

<h2>6. Data Security</h2>
<p>We implement appropriate technical and organizational security measures to protect your personal information against unauthorized access, alteration, disclosure, or destruction. These measures include:</p>
<ul>
    <li>Encryption of sensitive data in transit and at rest</li>
    <li>Regular security assessments and updates</li>
    <li>Limited access to personal information on a need-to-know basis</li>
    <li>Employee training on data protection and privacy</li>
</ul>

<p>However, no method of transmission over the Internet or electronic storage is 100% secure, and we cannot guarantee absolute security.</p>

<h2>7. Your Rights and Choices</h2>
<p>You have the right to:</p>
<ul>
    <li><strong>Access:</strong> Request a copy of your personal information</li>
    <li><strong>Correction:</strong> Update or correct inaccurate information</li>
    <li><strong>Deletion:</strong> Request deletion of your personal information</li>
    <li><strong>Opt-out:</strong> Unsubscribe from marketing communications</li>
    <li><strong>Data Portability:</strong> Request your data in a portable format</li>
    <li><strong>Withdraw Consent:</strong> Withdraw consent for data processing where applicable</li>
</ul>

<p>To exercise these rights, please contact us using the information provided below.</p>

<h2>8. Children''s Privacy</h2>
<p>Our services are not intended for individuals under the age of 18. We do not knowingly collect personal information from children. If you believe we have collected information from a child, please contact us immediately.</p>

<h2>9. Changes to This Policy</h2>
<p>We may update this Privacy Policy from time to time. We will notify you of any material changes by posting the new policy on this page and updating the "Last updated" date.</p>

<h2>10. Contact Us</h2>
<p>If you have questions about this Privacy Policy or our data practices, please contact us:</p>
<ul>
    <li><strong>Email:</strong> radstooling@gmail.com</li>
    <li><strong>Phone:</strong> +63 976 228 4270</li>
    <li><strong>Address:</strong> Green Breeze, Piela, Dasmariñas, Cavite</li>
</ul>'
), 'published', 1, 'System');

-- Insert TERMS & CONDITIONS with full content
INSERT INTO rt_cms_pages (page_key, page_name, content_data, status, version, updated_by) VALUES
('terms', 'Terms & Conditions', JSON_OBJECT(
    'content', '<h1>Terms & Conditions</h1>
<p><em>Effective Date: January 2024</em></p>

<h2>1. Acceptance of Terms</h2>
<p>By accessing and using the RADS Tooling website and services, you accept and agree to be bound by these Terms & Conditions. If you do not agree to these terms, please do not use our services.</p>

<p>These terms apply to all visitors, users, customers, and others who access or use our services, including but not limited to browsing our website, placing orders, or engaging with our custom tooling services.</p>

<h2>2. Accounts and Registration</h2>
<h3>Account Creation</h3>
<p>To access certain features of our services, you may be required to create an account. When creating an account, you must:</p>
<ul>
    <li>Provide accurate, current, and complete information</li>
    <li>Maintain and promptly update your account information</li>
    <li>Maintain the security of your password and account</li>
    <li>Notify us immediately of any unauthorized use of your account</li>
</ul>

<h3>Account Responsibilities</h3>
<p>You are responsible for all activities that occur under your account. We reserve the right to suspend or terminate accounts that violate these terms.</p>

<h2>3. Products and Services</h2>
<h3>Product Descriptions</h3>
<p>We make every effort to provide accurate product descriptions, specifications, and images. However:</p>
<ul>
    <li>Product images are for illustrative purposes and may differ slightly from actual products</li>
    <li>Colors may appear differently depending on your display settings</li>
    <li>We reserve the right to correct any errors or inaccuracies in product information</li>
</ul>

<h3>Custom Orders</h3>
<p>For custom cabinet orders:</p>
<ul>
    <li>A 30% down payment is required before production begins</li>
    <li>Final measurements and specifications must be approved before manufacturing</li>
    <li>Production timeline will be provided upon order confirmation</li>
    <li>Custom orders cannot be cancelled once production has started</li>
</ul>

<h2>4. Pricing and Payment</h2>
<h3>Pricing</h3>
<ul>
    <li>All prices are listed in Philippine Pesos (PHP) unless otherwise stated</li>
    <li>Prices are subject to change without notice</li>
    <li>We reserve the right to correct pricing errors</li>
    <li>Shipping and handling fees are additional unless stated otherwise</li>
</ul>

<h3>Payment Terms</h3>
<ul>
    <li>Payment is due at the time of order placement unless otherwise agreed</li>
    <li>We accept major credit cards, debit cards, and bank transfers</li>
    <li>For large orders, payment plans may be available upon approval</li>
</ul>

<h2>5. Cancellation Policy</h2>
<h3>Standard Products</h3>
<ul>
    <li>Orders may be cancelled within 24 hours of placement for a full refund</li>
    <li>After 24 hours, cancellation fees may apply</li>
    <li>Orders that have been shipped cannot be cancelled</li>
</ul>

<h3>Custom Products</h3>
<ul>
    <li>Custom orders can be cancelled before production begins with a 10% restocking fee</li>
    <li>Once production has started, custom orders cannot be cancelled</li>
    <li>Down payments for cancelled custom orders are non-refundable if production has begun</li>
</ul>

<h2>6. Shipping and Delivery</h2>
<ul>
    <li>Delivery timeframes are estimates and not guaranteed</li>
    <li>Shipping costs are calculated based on weight, size, and destination</li>
    <li>Risk of loss passes to you upon delivery to the carrier</li>
    <li>You must inspect deliveries upon receipt and report any damage within 48 hours</li>
</ul>

<h2>7. Returns and Refunds</h2>
<h3>Return Policy</h3>
<ul>
    <li>Standard products may be returned within 14 days of delivery</li>
    <li>Products must be unused, in original packaging, and in resalable condition</li>
    <li>Custom-made products are non-returnable</li>
    <li>Customers are responsible for return shipping costs unless the product is defective</li>
</ul>

<h3>Refund Processing</h3>
<ul>
    <li>Refunds will be processed within 7-14 business days of receiving the returned item</li>
    <li>Refunds will be issued to the original payment method</li>
    <li>Shipping fees are non-refundable</li>
</ul>

<h2>8. Warranties and Disclaimers</h2>
<h3>Product Warranty</h3>
<p>We warrant that our products are free from defects in materials and workmanship for a period of 1 year from the date of delivery. This warranty does not cover:</p>
<ul>
    <li>Normal wear and tear</li>
    <li>Damage caused by misuse or improper installation</li>
    <li>Modifications or repairs by unauthorized parties</li>
    <li>Damage from accidents or natural disasters</li>
</ul>

<h3>Disclaimer</h3>
<p>EXCEPT AS EXPRESSLY STATED, OUR SERVICES AND PRODUCTS ARE PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.</p>

<h2>9. Limitation of Liability</h2>
<p>To the maximum extent permitted by law, RADS Tooling shall not be liable for:</p>
<ul>
    <li>Indirect, incidental, or consequential damages</li>
    <li>Loss of profits, revenue, or data</li>
    <li>Business interruption</li>
</ul>

<p>Our total liability shall not exceed the amount paid by you for the product or service in question.</p>

<h2>10. Intellectual Property</h2>
<p>All content on our website, including text, graphics, logos, images, and software, is the property of RADS Tooling and protected by intellectual property laws. You may not:</p>
<ul>
    <li>Reproduce, distribute, or modify our content without permission</li>
    <li>Use our trademarks or logos without authorization</li>
    <li>Reverse engineer or decompile our software</li>
</ul>

<h2>11. Privacy</h2>
<p>Your use of our services is also governed by our Privacy Policy. Please review our Privacy Policy to understand our data practices.</p>

<h2>12. Changes to Terms</h2>
<p>We reserve the right to modify these terms at any time. Changes will be effective immediately upon posting. Your continued use of our services constitutes acceptance of the modified terms.</p>

<h2>13. Governing Law</h2>
<p>These terms are governed by the laws of the Republic of the Philippines. Any disputes shall be subject to the exclusive jurisdiction of the courts of Dasmariñas, Cavite.</p>

<h2>14. Contact Information</h2>
<p>For questions about these Terms & Conditions, please contact us:</p>
<ul>
    <li><strong>Company:</strong> RADS TOOLING INC.</li>
    <li><strong>Address:</strong> Green Breeze, Piela, Dasmariñas, Cavite</li>
    <li><strong>Phone:</strong> +63 976 228 4270</li>
    <li><strong>Email:</strong> radstooling@gmail.com</li>
</ul>'
), 'published', 1, 'System');

ALTER TABLE customers
  MODIFY username VARCHAR(50)
    CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL,
  MODIFY email VARCHAR(255)
    CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL;

-- drop old non-unique indexes if present:
ALTER TABLE customers
  DROP INDEX `username`,
  DROP INDEX `email`,
  DROP INDEX `idx_email`;

-- create unique ones:
ALTER TABLE customers
  ADD UNIQUE KEY `username_unique` (`username`),
  ADD UNIQUE KEY `email_unique` (`email`);

-- ============================================================
-- DONE - Database schema complete
-- ============================================================